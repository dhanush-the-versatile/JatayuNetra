<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergency SOS - Smart Tourist Safety</title>
    <link rel="stylesheet" href="styles.css">
    <meta name="theme-color" content="#dc2626">
</head>
<body>
    <div class="sos-container">
        <!-- SOS Header -->
        <div class="sos-header">
            <div class="sos-logo">üö®</div>
            <h1>EMERGENCY SOS</h1>
            <p>Smart Tourist Safety System</p>
            <div class="location-info">
                <span class="location-icon">üìç</span>
                <span class="location-text">Guwahati, Assam ‚Ä¢ 26.1445¬∞N, 91.7362¬∞E</span>
            </div>
        </div>

        <!-- Main SOS Button -->
        <div class="sos-main">
            <div class="sos-button-container">
                <button id="main-sos-button" class="main-sos-btn" onclick="activateSOS()">
                    <div class="sos-pulse-ring"></div>
                    <div class="sos-pulse-ring delay-1"></div>
                    <div class="sos-pulse-ring delay-2"></div>
                    <div class="sos-button-content">
                        <div class="sos-icon">üÜò</div>
                        <div class="sos-text">
                            <div class="sos-title">SOS</div>
                            <div class="sos-subtitle">EMERGENCY</div>
                        </div>
                    </div>
                </button>
                <p class="sos-instruction">Hold for 3 seconds to activate emergency alert</p>
            </div>

            <!-- Quick Emergency Actions -->
            <div class="quick-emergency-actions">
                <h3>Quick Emergency Actions</h3>
                <div class="emergency-actions-grid">
                    <button class="emergency-action-btn police-btn" onclick="quickCall('police')">
                        <div class="action-icon">üëÆ</div>
                        <div class="action-text">
                            <span class="action-title">Police</span>
                            <span class="action-number">100</span>
                        </div>
                    </button>

                    <button class="emergency-action-btn medical-btn" onclick="quickCall('medical')">
                        <div class="action-icon">üè•</div>
                        <div class="action-text">
                            <span class="action-title">Medical</span>
                            <span class="action-number">102</span>
                        </div>
                    </button>

                    <button class="emergency-action-btn tourist-btn" onclick="quickCall('tourist')">
                        <div class="action-icon">üõ°Ô∏è</div>
                        <div class="action-text">
                            <span class="action-title">Tourist Police</span>
                            <span class="action-number">1363</span>
                        </div>
                    </button>

                    <button class="emergency-action-btn family-btn" onclick="alertFamily()">
                        <div class="action-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                        <div class="action-text">
                            <span class="action-title">Alert Family</span>
                            <span class="action-number">Instant</span>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Emergency Status -->
            <div class="emergency-status">
                <div class="status-header">
                    <h3>System Status</h3>
                    <div class="status-indicator">
                        <div class="status-dot active"></div>
                        <span>All Systems Active</span>
                    </div>
                </div>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">GPS Location</div>
                        <div class="status-value active">‚úÖ Active (¬±3m)</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Emergency Contacts</div>
                        <div class="status-value active">‚úÖ 3 Contacts Ready</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Medical Profile</div>
                        <div class="status-value active">‚úÖ Available</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Communication</div>
                        <div class="status-value active">‚úÖ Network Strong</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">AI Monitoring</div>
                        <div class="status-value active">‚úÖ Real-time Active</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Emergency Services</div>
                        <div class="status-value active">‚úÖ Response Ready</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SOS Activation Screen -->
        <div id="sos-activation-screen" class="sos-activation hidden">
            <div class="activation-content">
                <div class="activation-header">
                    <div class="countdown-circle">
                        <div class="countdown-number" id="countdown-number">3</div>
                        <div class="countdown-text">seconds</div>
                    </div>
                    <h2>üö® SOS ACTIVATING</h2>
                    <p>Release button to cancel</p>
                </div>

                <div class="activation-actions">
                    <button class="cancel-btn" onclick="cancelSOS()">
                        <span class="btn-icon">‚ùå</span>
                        <span class="btn-text">Cancel</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- SOS Active Screen -->
        <div id="sos-active-screen" class="sos-active hidden">
            <div class="active-content">
                <div class="active-header">
                    <div class="active-icon">üö®</div>
                    <h2>SOS ACTIVATED</h2>
                    <p>Emergency services have been alerted</p>
                    <div class="sos-id">Emergency ID: <strong id="emergency-id"></strong></div>
                </div>

                <div class="active-status">
                    <div class="status-timeline">
                        <div class="timeline-item completed">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <span class="timeline-time">00:01</span>
                                <span class="timeline-text">Emergency alert sent</span>
                            </div>
                        </div>
                        <div class="timeline-item completed">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <span class="timeline-time">00:05</span>
                                <span class="timeline-text">Location shared with services</span>
                            </div>
                        </div>
                        <div class="timeline-item completed">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <span class="timeline-time">00:08</span>
                                <span class="timeline-text">Family contacts alerted</span>
                            </div>
                        </div>
                        <div class="timeline-item active">
                            <div class="timeline-dot pulsing"></div>
                            <div class="timeline-content">
                                <span class="timeline-time">00:15</span>
                                <span class="timeline-text">Emergency response dispatched</span>
                            </div>
                        </div>
                        <div class="timeline-item pending">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <span class="timeline-time">ETA 3 min</span>
                                <span class="timeline-text">Help arriving soon</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="active-info">
                    <div class="info-card">
                        <h4>üìç Your Location</h4>
                        <p>Guwahati, Assam</p>
                        <p>26.1445¬∞N, 91.7362¬∞E</p>
                        <p>Shared with emergency services</p>
                    </div>

                    <div class="info-card">
                        <h4>üö® Services Alerted</h4>
                        <ul>
                            <li>‚úÖ Police Emergency (100)</li>
                            <li>‚úÖ Medical Services (102)</li>
                            <li>‚úÖ Tourist Police (1363)</li>
                            <li>‚úÖ Family Contacts (3)</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h4>‚è±Ô∏è Response Times</h4>
                        <ul>
                            <li>Police: < 3 minutes</li>
                            <li>Medical: < 5 minutes</li>
                            <li>Tourist Police: < 2 minutes</li>
                        </ul>
                    </div>
                </div>

                <div class="active-actions">
                    <button class="contact-btn" onclick="callPoliceDirectly()">
                        <span class="btn-icon">üìû</span>
                        <span class="btn-text">Call Police Now</span>
                    </button>
                    <button class="safe-btn" onclick="markAsSafe()">
                        <span class="btn-icon">‚úÖ</span>
                        <span class="btn-text">I'm Safe Now</span>
                    </button>
                    <button class="cancel-btn secondary" onclick="cancelEmergency()">
                        <span class="btn-icon">‚ùå</span>
                        <span class="btn-text">False Alarm</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="sos-navigation">
            <button class="nav-back-btn" onclick="navigateTo('dashboard.html')">
                <span class="nav-icon">üè†</span>
                <span class="nav-text">Back to Dashboard</span>
            </button>
            <button class="nav-services-btn" onclick="navigateTo('services.html')">
                <span class="nav-icon">üö®</span>
                <span class="nav-text">Emergency Services</span>
            </button>
        </div>
    </div>

    <!-- Emergency Call Modal -->
    <div id="emergency-call-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìû Emergency Call</h3>
                <button class="modal-close" onclick="closeModal('emergency-call-modal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="call-info">
                    <div class="call-icon emergency-icon">üìû</div>
                    <div class="call-details">
                        <h4 id="call-service-name">Emergency Service</h4>
                        <p id="call-number">Loading...</p>
                        <div class="call-location">
                            <strong>Your Location:</strong> Guwahati, Assam (26.1445¬∞N, 91.7362¬∞E)
                        </div>
                        <div class="call-note">
                            <strong>Note:</strong> Your location and tourist profile will be shared automatically.
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn emergency" id="make-call-btn">
                        <span class="btn-icon">üìû</span>
                        <span class="btn-text">Call Now</span>
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal('emergency-call-modal')">
                        <span class="btn-text">Cancel</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Scripts -->
    <script src="main.js"></script>
    <script src="utils.js"></script>

    <script>
        let sosCountdownTimer = null;
        let sosActivationTimeout = null;
        let emergencyId = null;
        let sosActive = false;

        // SOS Activation Logic
        function activateSOS() {
            if (sosActive) return;
            
            const mainButton = document.getElementById('main-sos-button');
            const activationScreen = document.getElementById('sos-activation-screen');
            const countdownNumber = document.getElementById('countdown-number');
            
            let countdown = 3;
            countdownNumber.textContent = countdown;
            
            // Show activation screen
            activationScreen.classList.remove('hidden');
            activationScreen.style.opacity = '1';
            
            // Start countdown
            sosCountdownTimer = setInterval(() => {
                countdown--;
                countdownNumber.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(sosCountdownTimer);
                    completeSOSActivation();
                }
            }, 1000);
            
            // Vibrate if supported
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }
        }

        function completeSOSActivation() {
            const activationScreen = document.getElementById('sos-activation-screen');
            const activeScreen = document.getElementById('sos-active-screen');
            
            // Generate emergency ID
            emergencyId = 'SOS-' + Date.now().toString().substr(-6);
            document.getElementById('emergency-id').textContent = emergencyId;
            
            // Hide activation, show active screen
            activationScreen.style.opacity = '0';
            setTimeout(() => {
                activationScreen.classList.add('hidden');
                activeScreen.classList.remove('hidden');
                activeScreen.style.opacity = '1';
            }, 300);
            
            sosActive = true;
            
            // Simulate emergency response
            simulateEmergencyResponse();
            
            // Show success toast
            showToast('üö® EMERGENCY SOS ACTIVATED - Help is on the way!', 'emergency');
            
            // Continuous vibration for emergency
            if (navigator.vibrate) {
                navigator.vibrate([500, 200, 500, 200, 500]);
            }
        }

        function cancelSOS() {
            if (sosCountdownTimer) {
                clearInterval(sosCountdownTimer);
                sosCountdownTimer = null;
            }
            
            const activationScreen = document.getElementById('sos-activation-screen');
            activationScreen.style.opacity = '0';
            setTimeout(() => {
                activationScreen.classList.add('hidden');
            }, 300);
            
            showToast('‚ùå SOS activation cancelled', 'info');
        }

        function simulateEmergencyResponse() {
            // Simulate the emergency response timeline
            setTimeout(() => {
                updateTimelineItem(0, '00:01', 'Emergency alert sent to all services');
            }, 100);
            
            setTimeout(() => {
                updateTimelineItem(1, '00:05', 'GPS location shared with emergency teams');
            }, 2000);
            
            setTimeout(() => {
                updateTimelineItem(2, '00:08', 'Family and emergency contacts alerted');
            }, 4000);
            
            setTimeout(() => {
                updateTimelineItem(3, '00:15', 'Police unit dispatched - ETA 3 minutes');
            }, 6000);
        }

        function updateTimelineItem(index, time, text) {
            const timelineItems = document.querySelectorAll('.timeline-item');
            if (timelineItems[index]) {
                const timeElement = timelineItems[index].querySelector('.timeline-time');
                const textElement = timelineItems[index].querySelector('.timeline-text');
                if (timeElement) timeElement.textContent = time;
                if (textElement) textElement.textContent = text;
            }
        }

        function markAsSafe() {
            if (confirm('Are you sure you are safe now? This will notify emergency services that assistance is no longer needed.')) {
                sosActive = false;
                showToast('‚úÖ Marked as SAFE - Emergency services notified', 'success');
                setTimeout(() => {
                    navigateTo('dashboard.html');
                }, 2000);
            }
        }

        function cancelEmergency() {
            if (confirm('Cancel emergency alert? This will notify services it was a false alarm.')) {
                sosActive = false;
                showToast('‚ùå Emergency cancelled - False alarm reported', 'warning');
                setTimeout(() => {
                    navigateTo('dashboard.html');
                }, 2000);
            }
        }

        function quickCall(serviceType) {
            const services = {
                police: { name: 'Police Emergency', number: '100', icon: 'üëÆ' },
                medical: { name: 'Medical Emergency', number: '102', icon: 'üè•' },
                tourist: { name: 'Tourist Police', number: '1363', icon: 'üõ°Ô∏è' }
            };
            
            const service = services[serviceType];
            if (service) {
                if (confirm(`üìû Call ${service.name}?\n\nNumber: ${service.number}\nYour location will be shared automatically.`)) {
                    window.location.href = `tel:${service.number}`;
                    showToast(`üìû Calling ${service.name}...`, 'info');
                }
            }
        }

        function alertFamily() {
            const message = `üö® EMERGENCY ALERT
            
Tourist: Rajesh Kumar
Digital ID: TST-AS-2025-001234
Status: EMERGENCY - Requesting immediate assistance
Location: Guwahati, Assam (26.1445¬∞N, 91.7362¬∞E)
Time: ${new Date().toLocaleString()}

Emergency services have been contacted.
This is an automated alert from Smart Tourist Safety System.`;

            showToast('üì± Alerting all family contacts...', 'info');
            
            // Simulate family alert
            setTimeout(() => {
                showToast('‚úÖ All family contacts alerted successfully', 'success');
            }, 2000);
            
            // Copy to clipboard if available
            if (navigator.clipboard) {
                navigator.clipboard.writeText(message);
            }
        }

        function callPoliceDirectly() {
            window.location.href = 'tel:100';
        }

        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Initialize SOS page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üÜò Emergency SOS page loaded');
            
            // Add touch and mouse event handlers for SOS button
            const sosButton = document.getElementById('main-sos-button');
            let holdTimer = null;
            
            function startSOSHold() {
                holdTimer = setTimeout(() => {
                    activateSOS();
                }, 50); // Short delay to prevent accidental activation
            }
            
            function stopSOSHold() {
                if (holdTimer) {
                    clearTimeout(holdTimer);
                    holdTimer = null;
                }
            }
            
            // Mouse events
            sosButton.addEventListener('mousedown', startSOSHold);
            sosButton.addEventListener('mouseup', stopSOSHold);
            sosButton.addEventListener('mouseleave', stopSOSHold);
            
            // Touch events
            sosButton.addEventListener('touchstart', function(e) {
                e.preventDefault();
                startSOSHold();
            });
            
            sosButton.addEventListener('touchend', function(e) {
                e.preventDefault();
                stopSOSHold();
            });
            
            // Prevent context menu on long press
            sosButton.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });
        });

        // Handle page visibility changes
        document.addEventListener('visibilitychange', function() {
            if (document.hidden && sosActive) {
                // Keep emergency active even when page is hidden
                console.log('üì± SOS remains active in background');
            }
        });

        // Prevent accidental page close during emergency
        window.addEventListener('beforeunload', function(e) {
            if (sosActive) {
                e.preventDefault();
                e.returnValue = 'Emergency SOS is active. Are you sure you want to leave?';
                return e.returnValue;
            }
        });
    </script>

    <style>
        /* SOS Specific Styles */
        .sos-container {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--emergency-red) 0%, #b91c1c 100%);
            color: var(--white);
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .sos-header {
            text-align: center;
            padding: var(--space-2xl) var(--space-lg);
            animation: slideDown 0.6s ease-out;
        }

        .sos-logo {
            font-size: 4rem;
            margin-bottom: var(--space-lg);
            animation: pulse 2s ease-in-out infinite;
        }

        .sos-header h1 {
            font-size: var(--text-3xl);
            font-weight: 700;
            margin-bottom: var(--space-sm);
            letter-spacing: 0.1em;
        }

        .sos-header p {
            font-size: var(--text-lg);
            opacity: 0.9;
            margin-bottom: var(--space-xl);
        }

        .location-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            background: rgba(255, 255, 255, 0.2);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-full);
            backdrop-filter: blur(10px);
            display: inline-flex;
            font-size: var(--text-sm);
        }

        .location-icon {
            font-size: var(--text-lg);
        }

        .sos-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--space-lg);
            animation: fadeInUp 0.8s ease-out;
        }

        .sos-button-container {
            text-align: center;
            margin-bottom: var(--space-3xl);
        }

        .main-sos-btn {
            position: relative;
            width: 200px;
            height: 200px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
            border: 6px solid var(--white);
            color: var(--emergency-red);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        .main-sos-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }

        .main-sos-btn:active {
            transform: scale(0.95);
        }

        .sos-pulse-ring {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 3px solid rgba(255, 255, 255, 0.7);
            border-radius: var(--radius-full);
            animation: sosPulseRing 2s ease-out infinite;
        }

        .sos-pulse-ring.delay-1 {
            animation-delay: 0.5s;
        }

        .sos-pulse-ring.delay-2 {
            animation-delay: 1s;
        }

        .sos-button-content {
            text-align: center;
            pointer-events: none;
        }

        .sos-icon {
            font-size: 4rem;
            margin-bottom: var(--space-sm);
        }

        .sos-title {
            font-size: var(--text-2xl);
            font-weight: 700;
            letter-spacing: 0.1em;
            margin-bottom: var(--space-xs);
        }

        .sos-subtitle {
            font-size: var(--text-sm);
            font-weight: 600;
            opacity: 0.8;
            letter-spacing: 0.2em;
        }

        .sos-instruction {
            margin-top: var(--space-lg);
            font-size: var(--text-base);
            opacity: 0.9;
            font-weight: 500;
        }

        .quick-emergency-actions {
            width: 100%;
            max-width: 800px;
            margin-bottom: var(--space-3xl);
        }

        .quick-emergency-actions h3 {
            text-align: center;
            font-size: var(--text-xl);
            font-weight: 600;
            margin-bottom: var(--space-xl);
        }

        .emergency-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-lg);
        }

        .emergency-action-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            color: var(--white);
            cursor: pointer;
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .emergency-action-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .emergency-action-btn .action-icon {
            font-size: 2.5rem;
            margin-bottom: var(--space-md);
            display: block;
        }

        .emergency-action-btn .action-title {
            font-size: var(--text-base);
            font-weight: 600;
            margin-bottom: var(--space-sm);
            display: block;
        }

        .emergency-action-btn .action-number {
            font-size: var(--text-lg);
            font-weight: 700;
            opacity: 0.9;
            display: block;
        }

        .emergency-status {
            width: 100%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xl);
        }

        .status-header h3 {
            font-size: var(--text-xl);
            font-weight: 600;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .status-dot.active {
            width: 10px;
            height: 10px;
            background: var(--accent-green);
            border-radius: var(--radius-full);
            animation: pulse 2s ease-in-out infinite;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .status-item {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .status-label {
            font-size: var(--text-sm);
            opacity: 0.8;
            font-weight: 500;
        }

        .status-value {
            font-size: var(--text-sm);
            font-weight: 600;
        }

        .status-value.active {
            color: var(--accent-green);
        }

        /* SOS Activation Screen */
        .sos-activation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--emergency-red);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .activation-content {
            text-align: center;
            color: var(--white);
        }

        .countdown-circle {
            width: 150px;
            height: 150px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-full);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-xl);
            position: relative;
            animation: pulse 1s ease-in-out infinite;
        }

        .countdown-number {
            font-size: 4rem;
            font-weight: 700;
            line-height: 1;
        }

        .countdown-text {
            font-size: var(--text-sm);
            opacity: 0.8;
        }

        .activation-header h2 {
            font-size: var(--text-2xl);
            font-weight: 700;
            margin-bottom: var(--space-lg);
            letter-spacing: 0.05em;
        }

        .activation-header p {
            font-size: var(--text-lg);
            opacity: 0.9;
            margin-bottom: var(--space-2xl);
        }

        .activation-actions {
            display: flex;
            justify-content: center;
        }

        .cancel-btn {
            background: rgba(255, 255, 255, 0.2);
            color: var(--white);
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: var(--space-lg) var(--space-2xl);
            border-radius: var(--radius-xl);
            cursor: pointer;
            transition: all var(--transition-normal);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .cancel-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* SOS Active Screen */
        .sos-active {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, var(--emergency-red) 0%, #b91c1c 100%);
            color: var(--white);
            padding: var(--space-lg);
            overflow-y: auto;
            z-index: 10000;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .active-content {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--space-xl) 0;
        }

        .active-header {
            text-align: center;
            margin-bottom: var(--space-3xl);
        }

        .active-icon {
            font-size: 5rem;
            margin-bottom: var(--space-lg);
            animation: pulse 2s ease-in-out infinite;
        }

        .active-header h2 {
            font-size: var(--text-3xl);
            font-weight: 700;
            margin-bottom: var(--space-lg);
            letter-spacing: 0.05em;
        }

        .active-header p {
            font-size: var(--text-xl);
            opacity: 0.9;
            margin-bottom: var(--space-lg);
        }

        .sos-id {
            background: rgba(255, 255, 255, 0.2);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-lg);
            font-size: var(--text-lg);
            backdrop-filter: blur(10px);
            display: inline-block;
        }

        .active-status {
            margin-bottom: var(--space-3xl);
        }

        .status-timeline {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            backdrop-filter: blur(10px);
        }

        .timeline-item {
            display: flex;
            align-items: center;
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
            position: relative;
        }

        .timeline-item:last-child {
            margin-bottom: 0;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 30px;
            bottom: -15px;
            width: 2px;
            background: rgba(255, 255, 255, 0.3);
        }

        .timeline-item:last-child::before {
            display: none;
        }

        .timeline-dot {
            width: 30px;
            height: 30px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.3);
            border: 3px solid var(--white);
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }

        .timeline-item.completed .timeline-dot {
            background: var(--accent-green);
        }

        .timeline-item.active .timeline-dot {
            background: var(--white);
        }

        .timeline-dot.pulsing {
            animation: pulse 2s ease-in-out infinite;
        }

        .timeline-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .timeline-time {
            font-size: var(--text-sm);
            font-weight: 600;
            opacity: 0.9;
        }

        .timeline-text {
            font-size: var(--text-base);
            opacity: 0.8;
        }

        .timeline-item.completed .timeline-text {
            opacity: 1;
        }

        .active-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-3xl);
        }

        .info-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .info-card h4 {
            font-size: var(--text-lg);
            font-weight: 600;
            margin-bottom: var(--space-md);
        }

        .info-card p,
        .info-card li {
            font-size: var(--text-sm);
            opacity: 0.9;
            margin-bottom: var(--space-sm);
        }

        .info-card ul {
            list-style: none;
            padding: 0;
        }

        .info-card li {
            padding-left: var(--space-lg);
            position: relative;
        }

        .active-actions {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-md);
            justify-content: center;
        }

        .contact-btn,
        .safe-btn {
            background: rgba(255, 255, 255, 0.2);
            color: var(--white);
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: var(--space-lg) var(--space-xl);
            border-radius: var(--radius-xl);
            cursor: pointer;
            transition: all var(--transition-normal);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .safe-btn {
            background: rgba(16, 185, 129, 0.3);
            border-color: var(--accent-green);
        }

        .contact-btn:hover,
        .safe-btn:hover,
        .cancel-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .cancel-btn.secondary {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.7);
        }

        /* Navigation */
        .sos-navigation {
            position: fixed;
            bottom: var(--space-lg);
            left: var(--space-lg);
            right: var(--space-lg);
            display: flex;
            gap: var(--space-md);
            z-index: 100;
        }

        .nav-back-btn,
        .nav-services-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-xl);
            cursor: pointer;
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            font-weight: 500;
        }

        .nav-back-btn:hover,
        .nav-services-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: var(--text-lg);
        }

        /* Modal Overrides */
        .modal {
            background: rgba(220, 38, 38, 0.8);
        }

        .call-icon.emergency-icon {
            color: var(--emergency-red);
            animation: pulse 2s ease-in-out infinite;
        }

        .call-note {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-top: var(--space-sm);
            padding: var(--space-sm);
            background: var(--gray-50);
            border-radius: var(--radius-sm);
        }

        /* Animations */
        @keyframes sosPulseRing {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sos-header {
                padding: var(--space-xl) var(--space-md);
            }

            .main-sos-btn {
                width: 160px;
                height: 160px;
            }

            .sos-icon {
                font-size: 3rem;
            }

            .sos-title {
                font-size: var(--text-xl);
            }

            .emergency-actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .status-grid {
                grid-template-columns: 1fr;
            }

            .active-info {
                grid-template-columns: 1fr;
            }

            .active-actions {
                flex-direction: column;
            }

            .sos-navigation {
                flex-direction: column;
            }

            .timeline-item {
                flex-direction: column;
                text-align: center;
            }

            .timeline-item::before {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .main-sos-btn {
                width: 140px;
                height: 140px;
            }

            .emergency-actions-grid {
                grid-template-columns: 1fr;
            }

            .sos-header h1 {
                font-size: var(--text-2xl);
            }

            .active-header h2 {
                font-size: var(--text-2xl);
            }
        }
    </style>
</body>
</html>